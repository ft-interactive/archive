!function t(e,n,r){function a(i,s){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!s&&c)return c(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[i]={exports:{}};e[i][0].call(u.exports,function(t){var n=e[i][1][t];return a(n?n:t)},u,u.exports,t,e,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(t,e,n){"use strict";function r(){function t(){var t=a.select(".constituency-group__slope-graphic").node(),e=t.getBoundingClientRect(),n=12;d=e.width+n-(p.left+p.right),f=e.height-(p.top+p.bottom),h.range([f,0]),b.width(d).scale(h),a.selectAll("svg.slope-chart").each(function(t,e){var n=d+p.left+p.right,r=f+p.top+p.bottom,o=a.select(this);o.selectAll("g.slope-axis").attr("transform",function(t,e){return"translate("+e*d+",0)"}),o.selectAll("g.slope").call(b.reposition),o.attr({width:n,height:r})})}var e=c.graphics,n=180,r=100,l=2,u={width:38,height:10},p={top:u.height,left:l,bottom:u.height/2,right:u.width},f=r-(p.top+p.bottom),d=n-(p.left+p.right),h=a.scale.linear().domain([0,76]).range([f,0]),g=e.slope.layout().start(function(t){return t.resultnow}).end(function(t){return t.resultprediction}),b=e.slope.svg().width(d).radius(l).endClass(function(t){return" end-point "+i.className(t.data.party)}).startClass(function(t){return i.className(t.data.party)+" start-point"}).slopeClass(function(t){return i.className(t.data.party)+" slope"}).labelClass(function(t){return i.className(t.data.party)+" slope-label"}).label(function(t,e){return t.data.winner?i.shortName(t.data.party):void 0}).scale(h),v=a.selectAll(".constituency-group__slope-graphic").datum(function(){var t=c.data.constituencyLookup[this.dataset.constituency];return t.axes=0===Number(this.dataset.order),t});v.append("svg").attr({"class":"slope-chart","data-constituency":function(t){return t.id},width:n,height:r}).append("g").attr({transform:"translate("+p.left+","+p.top+")"}).each(function(t,e){if(t.axes){var o=a.select(this).append("g").attr({"class":"slope-axes"}).selectAll("g").data(["Last vote","Polling"]).enter().append("g").attr({transform:function(t,e){return"translate("+e*n+",0)"},"class":"slope-axis"});o.append("line").attr({"class":"axis-line",x1:0,y1:3,x2:0,y2:r}),o.append("text").attr({"class":"axis-label"}).text(function(t){return t})}a.select(this).selectAll("g.slope").data(g(t.parties)).call(b,t.axes)}),t();var y=o(function(e){t()},200);window.addEventListener("resize",y,!1),a.select(".result-table").call(c.graphics.resultTableDecorator),a.select(".coalition-table").call(c.graphics.coalitionsTableDecorator),a.json(s,function(t){a.selectAll(".constituency-group__locator-map-ratio").datum(function(){return battlegrounds[this.dataset.group]}).each(function(n,r){var o=e.constituencyLocator().width(this.offsetWidth).height(this.offsetHeight).map(t).locations(n.constituencies);a.select(this).call(o)})})}var a=t("d3"),o=t("lodash/function/debounce"),i=t("uk-political-parties"),s="../js/simplemap.json",c=document;c.graphics={},c.graphics.slope=t("./slope-chart/index.js"),c.graphics.constituencyLocator=t("./locator-map/constituency-locator.js"),c.graphics.resultTableDecorator=t("./table/projections-decorator.js"),c.graphics.coalitionsTableDecorator=t("./table/coalitions-decorator.js"),c.data={},c.data.constituencyLookup={},battlegrounds.forEach(function(t){t.constituencies.forEach(function(t){c.data.constituencyLookup[t.id]=t})}),r()},{"./locator-map/constituency-locator.js":2,"./slope-chart/index.js":3,"./table/coalitions-decorator.js":6,"./table/projections-decorator.js":7,d3:"d3","lodash/function/debounce":10,"uk-political-parties":"uk-political-parties"}],2:[function(t,e,n){"use strict";function r(){function t(){u&&(i=a.geo.albers().center([-4.1,55.2]).rotate([0,0]).parallels([50,60]).scale(c/l*850).translate([Math.floor(l/2),Math.floor(c/2)]),s=a.geo.path().projection(i),u=!1)}function e(e){t();var a=e.append("svg").attr({width:l,height:c,"class":"constituency-locator"});n&&a.selectAll(".constituency-locator__subunit").data(o.feature(n,n.objects.subunits).features).enter().append("path").attr("class",function(t){return"constituency-locator__subunit region-"+t.id.toLowerCase()}).attr("d",s),r&&a.selectAll("circle").data(r).enter().append("circle").attr({"class":function(t){return"constituency-locator__point "+t.holderpredicted},r:3,transform:function(t){return"translate("+i(t.coords)+")"}})}var n,r,i,s,c=300,l=200,u=!0;return e.locations=function(t){return u=!0,r=t,e},e.width=function(t){return u=!0,l=t,e},e.height=function(t){return u=!0,c=t,e},e.map=function(t){return u=!0,n=t,e},e}var a=t("d3"),o=t("topojson");e.exports=r},{d3:"d3",topojson:"topojson"}],3:[function(t,e,n){"use strict";e.exports={svg:t("./slope-svg.js"),layout:t("./slope-layout.js")}},{"./slope-layout.js":4,"./slope-svg.js":5}],4:[function(t,e,n){"use strict";function r(){function t(t){return t.map(function(t){return{slopeStart:e(t),slopeEnd:n(t),data:t}})}var e=function(t){return t.start},n=function(t){return t.start};return t.start=function(n){return e=n,t},t.end=function(e){return n=e,t},t}e.exports=r},{}],5:[function(t,e,n){"use strict";function r(){function t(r){r.enter().append("g").attr("class","slope"),r.append("line").attr({"class":o}).classed("_slope-line","true"),r.append("circle").attr({"class":e}).classed("_slope-start","true"),r.append("circle").attr({"class":n}).classed("_slope-end","true"),r.append("text").attr({"class":s}).text(i).classed("_slope-text","true"),t.reposition(r)}var e=a.functor("start-point"),n=a.functor("end-point"),r=a.functor(5),o=a.functor("slope"),i=a.functor(""),s=a.functor("slope-label"),c=a.functor("translate(4,4)"),l=200,u=a.scale.linear();return t.reposition=function(t){t.select("._slope-line").attr({x1:0,y1:function(t){return u(t.slopeStart)},x2:l,y2:function(t){return u(t.slopeEnd)}}),t.select("._slope-text").attr({x:l,y:function(t){return u(t.slopeEnd)},transform:c}),t.select("._slope-end").attr({r:r,cx:l,cy:function(t){return u(t.slopeEnd)}}),t.select("._slope-start").attr({r:r,cx:0,cy:function(t){return u(t.slopeStart)}})},t.radius=function(e){return r=a.functor(e),t},t.slopeClass=function(e){return o=a.functor(e),t},t.startClass=function(n){return e=a.functor(n),t},t.endClass=function(e){return n=a.functor(e),t},t.width=function(e){return l=a.functor(e),t},t.label=function(e){return i=e,t},t.labelClass=function(e){return s=e,t},t.scale=function(e){return u=e,t},t}var a=t("d3");e.exports=r},{d3:"d3"}],6:[function(t,e,n){"use strict";var r=t("d3"),a=t("uk-political-parties"),o=t("lodash/array/zipObject"),i=t("lodash/object/pairs");e.exports=function(t){function e(t,e){return t.selectAll(".bar-marker").data(e).enter().append("rect").attr({x:0,y:0,width:g,height:h,"class":"bar-marker"}),t}function n(t){return t.filter(function(t){return void 0!==t.label}).append("text").text(function(t){return t.label}).attr({"text-anchor":"end","class":"bar-label",transform:function(t){return"translate("+(g(t.total)-2)+",16)"}}),t}function s(t){function e(t){for(var e=i(t.parties).map(function(t){return{party:t[0],seats:t[1]}}),n=0,r=0;r<e.length;r++)e[r].cumulativeSeats=n,n+=e[r].seats;return e}t.selectAll("rect.stack-element").data(e).enter().append("rect").attr({"class":function(t){return"stack-element "+a.className(t.party)+"-area"},x:function(t){return g(t.cumulativeSeats)},y:0,width:function(t){return g(t.seats)},height:h})}var c={top:2,bottom:2,left:0,right:0},l=[],u=t.selectAll(".stacked-bar-column");u.each(function(t,e){l.push(this.dataset)}),l=l.map(function(t){var e=[];return t.seats&&t.parties&&(e=o(t.parties.split(","),t.seats.split(",").map(Number))),{label:t.label,total:Number(t.seatstotal),parties:e}});var p=[0,Math.max(330,r.max(l,function(t){return t.total}))],f=r.select("div.stacked-bar-column .visualisation").node().getBoundingClientRect(),d=f.width,h=20,g=r.scale.linear().range([0,f.width-(c.left+c.right)]).domain(p);u.select(".visualisation").data(l).append("svg").attr({width:d,height:h+(c.top+c.bottom)}).append("g").attr({"class":"coalition-cell-bar",transform:"translate("+c.left+","+c.top+")"}),r.selectAll("g.coalition-cell-bar").call(e,[326]).call(s).call(n)}},{d3:"d3","lodash/array/zipObject":8,"lodash/object/pairs":27,"uk-political-parties":"uk-political-parties"}],7:[function(t,e,n){"use strict";var r=t("d3"),a=t("uk-political-parties");e.exports=function(t){function e(t){return t.filter(function(t){return void 0!==t.label}).append("text").text(function(t){return t.label}).attr({"text-anchor":"end","class":"bar-label",transform:function(t){return"translate("+(d(t.seats)-2)+",16)"}}),t}function n(t,e){return t.selectAll(".bar-marker").data(e).enter().append("rect").attr({x:0,y:0,width:d,height:f,"class":"bar-marker"}),t}function o(t){return t.selectAll(".party-bar").data(function(t){return[t]}).enter().append("rect").attr({width:function(t){return d(t.seats)},height:f,"class":function(t){return a.className(t.party)+"-area party-bar"}}),t.selectAll(".party-bar").attr({width:function(t){return d(t.seats)},height:f,"class":function(t){return"none"===t.party?"none":a.className(t.party)+"-area party-bar"}}),t}var i={top:2,bottom:2,left:0,right:0},s=[],c=t.selectAll(".bar-column");c.each(function(t,e){s.push(this.dataset)});var l=[0,Math.max(330,r.max(s,function(t){return t.high}))],u=r.select("div.bar-column .visualisation").node().getBoundingClientRect(),p=u.width,f=20,d=r.scale.linear().range([0,u.width-(i.left+i.right)]).domain(l);c.select(".visualisation").data(s).append("svg").attr({width:p,height:f+(i.top+i.bottom)}).append("g").attr({"class":"result-cell-bar",transform:"translate("+i.left+","+i.top+")"}),t.selectAll("g.result-cell-bar").call(n,[326]).call(o).call(e)}},{d3:"d3","uk-political-parties":"uk-political-parties"}],8:[function(t,e,n){function r(t,e){var n=-1,r=t?t.length:0,o={};for(!r||e||a(t[0])||(e=[]);++n<r;){var i=t[n];e?o[i]=e[n]:i&&(o[i[0]]=i[1])}return o}var a=t("../lang/isArray");e.exports=r},{"../lang/isArray":21}],9:[function(t,e,n){var r=t("../internal/getNative"),a=r(Date,"now"),o=a||function(){return(new Date).getTime()};e.exports=o},{"../internal/getNative":13}],10:[function(t,e,n){function r(t,e,n){function r(){v&&clearTimeout(v),d&&clearTimeout(d),m=0,d=v=y=void 0}function c(e,n){n&&clearTimeout(n),d=v=y=void 0,e&&(m=o(),h=t.apply(b,f),v||d||(f=b=void 0))}function l(){var t=e-(o()-g);0>=t||t>e?c(y,d):v=setTimeout(l,t)}function u(){c(j,v)}function p(){if(f=arguments,g=o(),b=this,y=j&&(v||!w),x===!1)var n=w&&!v;else{d||w||(m=g);var r=x-(g-m),a=0>=r||r>x;a?(d&&(d=clearTimeout(d)),m=g,h=t.apply(b,f)):d||(d=setTimeout(u,r))}return a&&v?v=clearTimeout(v):v||e===x||(v=setTimeout(l,e)),n&&(a=!0,h=t.apply(b,f)),!a||v||d||(f=b=void 0),h}var f,d,h,g,b,v,y,m=0,x=!1,j=!0;if("function"!=typeof t)throw new TypeError(i);if(e=0>e?0:+e||0,n===!0){var w=!0;j=!1}else a(n)&&(w=!!n.leading,x="maxWait"in n&&s(+n.maxWait||0,e),j="trailing"in n?!!n.trailing:j);return p.cancel=r,p}var a=t("../lang/isObject"),o=t("../date/now"),i="Expected a function",s=Math.max;e.exports=r},{"../date/now":9,"../lang/isObject":24}],11:[function(t,e,n){function r(t){return function(e){return null==e?void 0:e[t]}}e.exports=r},{}],12:[function(t,e,n){var r=t("./baseProperty"),a=r("length");e.exports=a},{"./baseProperty":11}],13:[function(t,e,n){function r(t,e){var n=null==t?void 0:t[e];return a(n)?n:void 0}var a=t("../lang/isNative");e.exports=r},{"../lang/isNative":23}],14:[function(t,e,n){function r(t){return null!=t&&o(a(t))}var a=t("./getLength"),o=t("./isLength");e.exports=r},{"./getLength":12,"./isLength":16}],15:[function(t,e,n){function r(t,e){return t="number"==typeof t||a.test(t)?+t:-1,e=null==e?o:e,t>-1&&t%1==0&&e>t}var a=/^\d+$/,o=9007199254740991;e.exports=r},{}],16:[function(t,e,n){function r(t){return"number"==typeof t&&t>-1&&t%1==0&&a>=t}var a=9007199254740991;e.exports=r},{}],17:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}e.exports=r},{}],18:[function(t,e,n){function r(t){for(var e=c(t),n=e.length,r=n&&t.length,l=!!r&&s(r)&&(o(t)||a(t)),p=-1,f=[];++p<n;){var d=e[p];(l&&i(d,r)||u.call(t,d))&&f.push(d)}return f}var a=t("../lang/isArguments"),o=t("../lang/isArray"),i=t("./isIndex"),s=t("./isLength"),c=t("../object/keysIn"),l=Object.prototype,u=l.hasOwnProperty;e.exports=r},{"../lang/isArguments":20,"../lang/isArray":21,"../object/keysIn":26,"./isIndex":15,"./isLength":16}],19:[function(t,e,n){function r(t){return a(t)?t:Object(t)}var a=t("../lang/isObject");e.exports=r},{"../lang/isObject":24}],20:[function(t,e,n){function r(t){return o(t)&&a(t)&&s.call(t,"callee")&&!c.call(t,"callee")}var a=t("../internal/isArrayLike"),o=t("../internal/isObjectLike"),i=Object.prototype,s=i.hasOwnProperty,c=i.propertyIsEnumerable;e.exports=r},{"../internal/isArrayLike":14,"../internal/isObjectLike":17}],21:[function(t,e,n){var r=t("../internal/getNative"),a=t("../internal/isLength"),o=t("../internal/isObjectLike"),i="[object Array]",s=Object.prototype,c=s.toString,l=r(Array,"isArray"),u=l||function(t){return o(t)&&a(t.length)&&c.call(t)==i};e.exports=u},{"../internal/getNative":13,"../internal/isLength":16,"../internal/isObjectLike":17}],22:[function(t,e,n){function r(t){return a(t)&&s.call(t)==o}var a=t("./isObject"),o="[object Function]",i=Object.prototype,s=i.toString;e.exports=r},{"./isObject":24}],23:[function(t,e,n){function r(t){return null==t?!1:a(t)?u.test(c.call(t)):o(t)&&i.test(t)}var a=t("./isFunction"),o=t("../internal/isObjectLike"),i=/^\[object .+?Constructor\]$/,s=Object.prototype,c=Function.prototype.toString,l=s.hasOwnProperty,u=RegExp("^"+c.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},{"../internal/isObjectLike":17,"./isFunction":22}],24:[function(t,e,n){function r(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=r},{}],25:[function(t,e,n){var r=t("../internal/getNative"),a=t("../internal/isArrayLike"),o=t("../lang/isObject"),i=t("../internal/shimKeys"),s=r(Object,"keys"),c=s?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&a(t)?i(t):o(t)?s(t):[]}:i;e.exports=c},{"../internal/getNative":13,"../internal/isArrayLike":14,"../internal/shimKeys":18,"../lang/isObject":24}],26:[function(t,e,n){function r(t){if(null==t)return[];c(t)||(t=Object(t));var e=t.length;e=e&&s(e)&&(o(t)||a(t))&&e||0;for(var n=t.constructor,r=-1,l="function"==typeof n&&n.prototype===t,p=Array(e),f=e>0;++r<e;)p[r]=r+"";for(var d in t)f&&i(d,e)||"constructor"==d&&(l||!u.call(t,d))||p.push(d);return p}var a=t("../lang/isArguments"),o=t("../lang/isArray"),i=t("../internal/isIndex"),s=t("../internal/isLength"),c=t("../lang/isObject"),l=Object.prototype,u=l.hasOwnProperty;e.exports=r},{"../internal/isIndex":15,"../internal/isLength":16,"../lang/isArguments":20,"../lang/isArray":21,"../lang/isObject":24}],27:[function(t,e,n){function r(t){t=o(t);for(var e=-1,n=a(t),r=n.length,i=Array(r);++e<r;){var s=n[e];i[e]=[s,t[s]]}return i}var a=t("./keys"),o=t("../internal/toObject");e.exports=r},{"../internal/toObject":19,"./keys":25}]},{},[1]);
