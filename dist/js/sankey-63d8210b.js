!function t(e,n,r){function a(c,i){if(!n[c]){if(!e[c]){var u="function"==typeof require&&require;if(!i&&u)return u(c,!0);if(o)return o(c,!0);var s=new Error("Cannot find module '"+c+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){var n=e[c][1][t];return a(n?n:t)},l,l.exports,t,e,n,r)}return n[c].exports}for(var o="function"==typeof require&&require,c=0;c<r.length;c++)a(r[c]);return a}({1:[function(t,e,n){"use strict";function r(t){h.select("#sankey svg").remove();var e=h.select("#sankey").node().getBoundingClientRect(),n=540,r=e.width,l={top:30,left:0,bottom:40,right:0},p=n-(l.top+l.bottom),y=r-(l.left+l.right),g=20,m=h.sankey().size([y,p]).nodeWidth(x).nodePadding(g).nodes(t.nodes).links(t.links).layout(32),E=m.link(),L=h.select("#sankey").append("svg").attr({width:r,height:n,"class":"sankey"}),w=L.append("defs").selectAll("linearGradient").data(t.links).enter().append("linearGradient").attr({id:v,x1:"0%",x2:"100%",y1:"0%",y2:"0%"});w.append("stop").attr({offset:"0%"}).style("stop-color",function(t){return A(t.source.name)}).style("stop-opacity",1),w.append("stop").attr({offset:"100%"}).style("stop-color",function(t){return A(t.target.name)}).style("stop-opacity",1),L.selectAll("text.axis-label").data(["Current","Predicted"]).enter().append("text").attr({"class":"axis-label","text-anchor":function(t,e){return 0===e?"start":"end"},transform:function(t,e){var n=(r-l.right)*e,a=l.top-8;return"translate("+n+","+a+")"}}).text(function(t){return t}),L=L.append("g").attr("transform","translate("+l.left+","+l.top+")");var O=L.append("g").selectAll(".link").data(t.links).enter().append("g").attr("class","link-container");O.append("path").attr({"class":function(t){return"link "+d(t)},"data-from":function(t){return f(t.source.name)},"data-to":function(t){return f(t.target.name)},d:E}).style("stroke-width",function(t){return Math.max(1,t.dy)}),O.append("text").attr({x:x+6,y:function(t){return t.source.y+t.sy+t.dy/2},"data-from":function(t){return f(t.source.name)},"data-to":function(t){return f(t.target.name)},"class":"source link-label inactive",dy:".35em"}).text(function(t){return j(t.source.name)+": "+t.value}),O.append("text").attr({x:y-(x+6),y:function(t){return t.target.y+t.ty+t.dy/2},"data-from":function(t){return f(t.source.name)},"data-to":function(t){return f(t.target.name)},dy:".35em","class":"target link-label inactive","text-anchor":"end"}).text(function(t){return j(t.target.name)+": "+t.value});var T=L.append("g").selectAll(".node").data(t.nodes).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.x+","+t.y+")"});T.append("rect").attr("height",function(t){return Math.max(1,t.dy)}).attr("width",m.nodeWidth()).attr("class",function(t){return"node "+f(t.name)}).append("title").text(function(t){return t.name+" "+t.value}),T.append("rect").attr("height",function(t){return t.dy+g}).attr("y",function(t){return-g/2}).attr("x",function(t){return t.x>y/2?-y/2+m.nodeWidth():0}).attr("width",y/2).attr("class","selection-rect").append("title").text(function(t){return t.name+" "+t.value}),T.append("text").attr({x:-6,y:function(t){return t.dy/2},dy:".35em","text-anchor":"end",transform:null,"class":"target node-label","data-party":function(t){return f(t.name)}}).text(function(t){return j(t.name)+": "+t.value}).filter(function(t){return t.x<r/2}).attr({x:6+m.nodeWidth(),"class":"source node-label","text-anchor":"start"}),h.selectAll(".node").on("click",function(t){s();var e=c(t);u(e.list.join(", ")),i(e.direction,e.party)}).on("mouseover",function(t){o(),a(c(t).list.join(", "))}).on("mouseout",function(){o()}),h.selectAll("path").on("click",function(t){s(),u("."+d(t)),i("both",t.source.name,t.target.name)});var M=L.append("g");M.call(k),M.attr("transform","translate("+(r-32)+","+(n-52)+")");var N=L.append("g");N.attr("transform","translate(0,"+(n-34)+")"),N.append("text").attr({id:"svg-source"}).text("Source: electionforecast.co.uk, "+b)}function a(t){h.selectAll(t).classed("hint",!0)}function o(){h.selectAll("path.link").classed("hint",!1)}function c(t){var e=[],n="to",r="";return t.sourceLinks.forEach(function(t){e.push("."+d(t)),n="from",r=t.source.name}),t.targetLinks.forEach(function(t){e.push("."+d(t)),r=t.target.name}),{list:e,direction:n,party:r}}function i(t,e,n){return h.selectAll("text.node-label").classed("inactive",!0),h.selectAll("text.link-label").classed("inactive",!0),t&&e?void("both"===t?h.selectAll('.link-label[data-to="'+f(n)+'"][data-from="'+f(e)+'"]').classed("inactive",!1):"to"===t?(h.selectAll(".source.link-label[data-"+t+'="'+f(e)+'"]').classed("inactive",!1),h.selectAll('.target.node-label[data-party="'+f(e)+'"]').classed("inactive",!1)):(h.selectAll(".target.link-label[data-"+t+'="'+f(e)+'"]').classed("inactive",!1),h.selectAll('.source.node-label[data-party="'+f(e)+'"]').classed("inactive",!1))):void h.selectAll("text.node-label").classed("inactive",!1)}function u(t){h.selectAll(t).classed("selected",!0).style("stroke",p).style("stroke-opacity",1).call(function(t){return l(t.data()),this})}function s(){h.selectAll("rect").classed("selected",!1),h.selectAll("path").classed("selected",!1).style("stroke",null).style("stroke-opacity",null),h.selectAll("text.line-label").classed("inactive",!0),h.selectAll(".node text").classed("inactive",!1)}function l(t){function e(t,e){var n="seats";return 1===t.value&&(n="seat"),t.source.name===t.target.name?t.source.name+" retain <b>"+t.value+"</b> "+n:e?t.source.name+" lose <b>"+t.value+"</b> "+n+" to "+t.target.name:t.target.name+" gain <b>"+t.value+"</b> "+n+" from "+t.source.name}var n=t.sort(function(t,e){return e.value-t.value}),r=h.selectAll(".info-pane").selectAll("div").data(n);r.exit().remove(),r.enter().append("div");var a=!1;t.length>1&&(a=t[0].target!==t[1].target),r.html(function(t){return e(t,a)})}function f(t){return t.replace(/\s/g,"-").toLowerCase()}function d(t){return f(t.source.name+"-to-"+t.target.name)}function p(t){return t.source.name===t.target.name?A(t.source.name):"url(#"+v(t)+")"}function v(t){return f(t.source.name)+"--"+f(t.target.name)+"-gradient"}var h=t("d3");h.sankey=t("./sankey/d3plugin.js");var y=t("lodash/function/debounce"),g=t("uk-political-parties"),m=t("./sankey/sankey-data.js"),k=t("./sankey/logo.js"),x=30,b="",E=h.time.format("%B %e, %Y %I:%M %p");b=E(updateTime);var L=m(forecast),A=g.converter("colour","electionForecast"),j=g.converter("short","electionForecast"),w=y(function(t){r(L)},200);window.addEventListener("resize",w,!1),r(L),h.select("#svg-source").text("Source: electionforecast.co.uk, "+b),h.selectAll(".chart-preset").on("click",function(){s(),h.event.preventDefault();var t=h.select(this).attr("data-party"),e=h.select(this).attr("data-direction");e&&t?(u("path[data-"+e+"="+t+"]",e),i(e,t)):(s(),i("",""))})},{"./sankey/d3plugin.js":2,"./sankey/logo.js":3,"./sankey/sankey-data.js":4,d3:"d3","lodash/function/debounce":6,"uk-political-parties":"uk-political-parties"}],2:[function(t,e,n){"use strict";var r=t("d3");e.exports=function(){function t(){v.forEach(function(t){t.sourceLinks=[],t.targetLinks=[]}),h.forEach(function(t){var e=t.source,n=t.target;"number"==typeof e&&(e=t.source=v[t.source]),"number"==typeof n&&(n=t.target=v[t.target]),e.sourceLinks.push(t),n.targetLinks.push(t)})}function e(){v.forEach(function(t){t.value=Math.max(r.sum(t.sourceLinks,s),r.sum(t.targetLinks,s))})}function n(){for(var t,e=v,n=0;e.length;)t=[],e.forEach(function(e){e.x=n,e.dx=f,e.sourceLinks.forEach(function(e){t.indexOf(e.target)<0&&t.push(e.target)})}),e=t,++n;a(n),o((p[0]-f)/(n-1))}function a(t){v.forEach(function(e){e.sourceLinks.length||(e.x=t-1)})}function o(t){v.forEach(function(e){e.x*=t})}function c(t){function e(){var t=r.min(i,function(t){return(p[1]-(t.length-1)*d)/r.sum(t,s)});i.forEach(function(e){e.forEach(function(e,n){e.y=n,e.dy=e.value*t})}),h.forEach(function(e){e.dy=e.value*t})}function n(t){function e(t){return u(t.source)*t.value}i.forEach(function(n,a){n.forEach(function(n){if(n.targetLinks.length){var a=r.sum(n.targetLinks,e)/r.sum(n.targetLinks,s);n.y+=(a-u(n))*t}})})}function a(t){function e(t){return u(t.target)*t.value}i.slice().reverse().forEach(function(n){n.forEach(function(n){if(n.sourceLinks.length){var a=r.sum(n.sourceLinks,e)/r.sum(n.sourceLinks,s);n.y+=(a-u(n))*t}})})}function o(){i.forEach(function(t){var e,n,r,a=0,o=t.length;for(t.sort(c),r=0;o>r;++r)e=t[r],n=a-e.y,n>0&&(e.y+=n),a=e.y+e.dy+d;if(n=a-d-p[1],n>0)for(a=e.y-=n,r=o-2;r>=0;--r)e=t[r],n=e.y+e.dy+d-a,n>0&&(e.y-=n),a=e.y})}function c(t,e){return t.y-e.y}var i=r.nest().key(function(t){return t.x}).sortKeys(r.ascending).entries(v).map(function(t){return t.values});e(),o();for(var l=1;t>0;--t)a(l*=.99),o(),n(l),o()}function i(){function t(t,e){return t.source.y-e.source.y}function e(t,e){return t.target.y-e.target.y}v.forEach(function(n){n.sourceLinks.sort(e),n.targetLinks.sort(t)}),v.forEach(function(t){var e=0,n=0;t.sourceLinks.forEach(function(t){t.sy=e,e+=t.dy}),t.targetLinks.forEach(function(t){t.ty=n,n+=t.dy})})}function u(t){return t.y+t.dy/2}function s(t){return t.value}var l={},f=24,d=8,p=[1,1],v=[],h=[];return l.nodeWidth=function(t){return arguments.length?(f=+t,l):f},l.nodePadding=function(t){return arguments.length?(d=+t,l):d},l.nodes=function(t){return arguments.length?(v=t,l):v},l.links=function(t){return arguments.length?(h=t,l):h},l.size=function(t){return arguments.length?(p=t,l):p},l.layout=function(r){return t(),e(),n(),c(r),i(),l},l.relayout=function(){return i(),l},l.link=function(){function t(t){var n=t.source.x+t.source.dx,a=t.target.x,o=r.interpolateNumber(n,a),c=o(e),i=o(1-e),u=t.source.y+t.sy+t.dy/2,s=t.target.y+t.ty+t.dy/2;return"M"+n+","+u+"C"+c+","+u+" "+i+","+s+" "+a+","+s}var e=.5;return t.curvature=function(n){return arguments.length?(e=+n,t):e},t},l}},{d3:"d3"}],3:[function(t,e,n){"use strict";function r(t,e){e||(e=32);var n="M21.777,53.336c0,6.381,1.707,7.1,8.996,7.37v2.335H1.801v-2.335c6.027-0.27,7.736-0.989,7.736-7.37v-41.67 c0-6.387-1.708-7.104-7.556-7.371V1.959h51.103l0.363,13.472h-2.519c-2.16-6.827-4.502-8.979-16.467-8.979h-9.27 c-2.785,0-3.415,0.624-3.415,3.142v19.314h4.565c9.54,0,11.61-1.712,12.779-8.089h2.338v21.559h-2.338 c-1.259-7.186-4.859-8.981-12.779-8.981h-4.565V53.336z M110.955,1.959H57.328l-1.244,13.477h3.073c1.964-6.601,4.853-8.984,11.308-8.984h7.558v46.884 c0,6.381-1.71,7.1-8.637,7.37v2.335H98.9v-2.335c-6.931-0.27-8.64-0.989-8.64-7.37V6.453h7.555c6.458,0,9.351,2.383,11.309,8.984 h3.075L110.955,1.959z",r=t.append("path").attr("d",n),a=r.node().getBoundingClientRect(),o=Math.min(e/a.width,e/a.height);r.attr({transform:"scale("+o+")",fill:"rgba(0,0,0,0.1)"})}e.exports=r},{}],4:[function(t,e,n){"use strict";function r(t){var e=0,n="";for(var r in t)t.hasOwnProperty(r)&&(isNaN(t[r])||(e=Math.max(e,parseInt(t[r])),e===parseInt(t[r])&&(n=r)));return n}e.exports=function(t){var e={},n={};t=t.map(function(t){return t.forecast=r(t),t});for(var a=650-t.length,o=0;a>o;o++)t.push({current:"Other",forecast:"Other"});t.forEach(function(t){n[t.current+"->"+t.forecast]||(n[t.current+"->"+t.forecast]=0),n[t.current+"->"+t.forecast]++,e[t.forecast+"-forecast"]=!0,e[t.current+"-current"]=!0});var c={},i={nodes:Object.keys(e).map(function(t,e){return c[t]=e,{name:t.split("-")[0]}}),links:[]};for(var u in n)if(n.hasOwnProperty(u)){var s=u.split("->");i.links.push({source:c[s[0]+"-current"],target:c[s[1]+"-forecast"],value:n[u]})}return i}},{}],5:[function(t,e,n){var r=t("../internal/getNative"),a=r(Date,"now"),o=a||function(){return(new Date).getTime()};e.exports=o},{"../internal/getNative":7}],6:[function(t,e,n){function r(t,e,n){function r(){g&&clearTimeout(g),p&&clearTimeout(p),k=0,p=g=m=void 0}function u(e,n){n&&clearTimeout(n),p=g=m=void 0,e&&(k=o(),v=t.apply(y,d),g||p||(d=y=void 0))}function s(){var t=e-(o()-h);0>=t||t>e?u(m,p):g=setTimeout(s,t)}function l(){u(b,g)}function f(){if(d=arguments,h=o(),y=this,m=b&&(g||!E),x===!1)var n=E&&!g;else{p||E||(k=h);var r=x-(h-k),a=0>=r||r>x;a?(p&&(p=clearTimeout(p)),k=h,v=t.apply(y,d)):p||(p=setTimeout(l,r))}return a&&g?g=clearTimeout(g):g||e===x||(g=setTimeout(s,e)),n&&(a=!0,v=t.apply(y,d)),!a||g||p||(d=y=void 0),v}var d,p,v,h,y,g,m,k=0,x=!1,b=!0;if("function"!=typeof t)throw new TypeError(c);if(e=0>e?0:+e||0,n===!0){var E=!0;b=!1}else a(n)&&(E=!!n.leading,x="maxWait"in n&&i(+n.maxWait||0,e),b="trailing"in n?!!n.trailing:b);return f.cancel=r,f}var a=t("../lang/isObject"),o=t("../date/now"),c="Expected a function",i=Math.max;e.exports=r},{"../date/now":5,"../lang/isObject":11}],7:[function(t,e,n){function r(t,e){var n=null==t?void 0:t[e];return a(n)?n:void 0}var a=t("../lang/isNative");e.exports=r},{"../lang/isNative":10}],8:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}e.exports=r},{}],9:[function(t,e,n){function r(t){return a(t)&&i.call(t)==o}var a=t("./isObject"),o="[object Function]",c=Object.prototype,i=c.toString;e.exports=r},{"./isObject":11}],10:[function(t,e,n){function r(t){return null==t?!1:a(t)?l.test(u.call(t)):o(t)&&c.test(t)}var a=t("./isFunction"),o=t("../internal/isObjectLike"),c=/^\[object .+?Constructor\]$/,i=Object.prototype,u=Function.prototype.toString,s=i.hasOwnProperty,l=RegExp("^"+u.call(s).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},{"../internal/isObjectLike":8,"./isFunction":9}],11:[function(t,e,n){function r(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=r},{}]},{},[1]);