!function t(a,e,r){function n(s,l){if(!e[s]){if(!a[s]){var o="function"==typeof require&&require;if(!l&&o)return o(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=e[s]={exports:{}};a[s][0].call(c.exports,function(t){var e=a[s][1][t];return n(e?e:t)},c,c.exports,t,a,e,r)}return e[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,a,e){"use strict";function r(t,a){var e={parties:["lab","c"],labelThreshold:7,radius:100,labelOffset:5,width:600,height:200};for(var r in a)a.hasOwnProperty(r)&&(e[r]=a[r]);var c=o.svg.arc().outerRadius(e.radius-10).innerRadius(e.radius/3),d=t.append("g").attr({"class":"main-segment",transform:"translate("+e.width/2+","+e.height/2+")"});d.append("path").attr({d:c,"class":function(t){var a="pie-segment ";return t.data.parties.forEach(function(t){e.parties.indexOf(t)>-1&&(a+=" "+u.className(t))}),a}}),d.append("text").attr({id:function(t){return l(t.data.name)},transform:function(t){var a=i(t),r=s(a,e.radius+e.labelOffset);return"translate("+r.x+","+r.y+")"},"text-anchor":function(t){return i(t)>Math.PI?"end":"start"}}).filter(function(t){return t.data.probability>e.labelThreshold}).call(n)}function n(t){var a=1;t.each(function(t){var e=t.data.name.split(/\/(.+)/).filter(function(t){return""!==t});e[0]=t.data.probability+"% "+e[0],e[1]&&(e[1]="/"+e[1]),o.select(this).selectAll("tspan").data(e).enter().append("tspan").attr({dy:function(t,e){return e*a+"em"},x:0}).text(function(t,a){return t})})}function i(t){return t.startAngle+(t.endAngle-t.startAngle)/2}function s(t,a){return t=-t+Math.PI,{x:a*Math.sin(t),y:a*Math.cos(t)}}function l(t){return t.replace(/[\W\s]/g,"-")}var o=t("d3"),u=t("uk-political-parties"),c=["lab","c"],d=["snp","ld","ukip","dup","green","pc"],p={top:0,right:0,bottom:0,left:0},f=600-p.left-p.right,h=250-p.top-p.bottom,v=o.layout.pie().sort(null).value(function(t){return t.probability}),g=v(coalitions),b={};coalitions.forEach(function(t){t.parties.forEach(function(a){b[a]||(b[a]=0),b[a]+=t.probability})});var m=o.select("#main-visualisation").append("div").attr({"class":"pie-headline o-grid-row"});m.append("div").attr({"class":u.className("c"),"data-o-grid-colspan":"6"}).text(u.fullName("c")+" "+o.round(b.c,1)+"%"),m.append("div").attr({"class":u.className("lab"),"data-o-grid-colspan":"6"}).text(u.fullName("lab")+" "+o.round(b.lab,1)+"%");var x=o.select("#main-visualisation").append("svg").attr("width","100%").attr("height","100%").attr("viewBox","0 0 "+(f+(p.left+p.right))+" "+(h+(p.top+p.bottom))).append("g").attr("transform","translate("+p.left+","+p.top+")");x.selectAll("g.main-segment").data(g).enter().call(r,{parties:c,width:f,height:h}),o.select("#sub-visualisation").selectAll("div.individual-party").data(d).enter().append("div").attr({"class":"sub-pie-container","data-o-grid-colspan":"4"}).each(function(t){var a=o.select(this);a.append("div").attr("class",function(t){return t.toLowerCase()+" sub-pie-header"}).html(function(t){return u.shortName(t)+" <b>"+o.round(b[t],1)+"%</b>"}),a.append("svg").attr({width:"50%",height:"50%",viewBox:"0 0 100 100"}).selectAll("g.sub-segment").data(g).enter().call(r,{parties:[t],width:100,height:100,radius:50,labelThreshold:100})})},{d3:"d3","uk-political-parties":"uk-political-parties"}]},{},[1]);
