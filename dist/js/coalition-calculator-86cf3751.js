!function t(e,n,r){function a(s,o){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){var n=e[s][1][t];return a(n?n:t)},u,u.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)a(r[s]);return a}({1:[function(t,e,n){"use strict";function r(t){var e=0;for(var n in t)t.hasOwnProperty(n)&&(e+=t[n]);return 650===e}function a(){if(window.location.hash){var t={};if(window.location.hash.split(",").forEach(function(e){e=e.split(":"),t[e[0].replace("#","")]=parseInt(e[1])}),!r(t))return;for(var e in k)void 0!==t[k[e].party]&&(k[e].seats=+t[k[e].party]);s()}}function i(){history.replaceState("","","#"+k.map(function(t){return t.party+":"+t.seats}).join(","))}function s(){b.selectAll(".preset-adjustment.selected").classed("selected",!1)}function o(){return N.map(function(t){return{parties:t,singleParty:1===t.length,seats:t.reduce(function(t,e){return c(e).seats+t},0)}})}function l(t,e){return e||(e="Seats"),t.map(function(t){return{party:t.Party,seats:t[e]}})}function c(t){return k[E[t]]}function u(t,e){for(var n=0,r=0;r<t.length;r++)t[r].startPos=n,n+=e(t[r].seats),t[r].endPos=n;return t}function p(t,e){return t.map(function(t){return t.seats=Math.round(e.invert(t.endPos-t.startPos)),t})}function d(t){return t=b.select(t),{x:t.attr("x")+b.transform(t.attr("transform")).translate[0],y:t.attr("y")+b.transform(t.attr("transform")).translate[1]}}function f(){a();var t=b.select(".seats-input").node().getBoundingClientRect(),e=b.select(".coalition-display").node().getBoundingClientRect();A.domain([0,650]).range([0,t.width-(P.left+P.right)]),O.domain([0,650]).range([0,e.width-(j.left+j.right)]),_=b.select(".seats-input").node().dataset.parties.split(",");var n=["ld","c","lab","snp","dup","pc","ukip","sdlp","green","other"];k=k.sort(function(t,e){return n.indexOf(t.party)-n.indexOf(e.party)}),k=u(k,A),k.forEach(function(t,e){E[t.party]=e}),b.select(".seats-input").selectAll(".slider-input").data([1]).enter().append("svg").append("g").attr({transform:"translate( "+P.left+","+P.top+" )",id:"slider"}),b.select(".seats-input svg").attr({width:t.width,height:C,"class":"slider-input"}),b.select(".coalition-display").selectAll(".coalitions-display").data([1]).enter().append("svg"),b.select(".coalition-display svg").attr({width:e.width,height:C,"class":"coalitions-display"}),b.selectAll(".preset-adjustment").on("click",function(){b.event.preventDefault(),s(),b.select(this).classed("selected",!0);var t=this.dataset;for(var e in k)t[k[e].party]&&(k[e].seats=+t[k[e].party]);return k=u(k,A),y(),m(),i(),!1})}function y(){function t(t,e,n){var r=c(e).startPos,a=c(n).endPos;if("snp"===n){var i=A(59),s=c("snp").endPos;if(s-i>t)return s-i}return Math.max(Math.min(a,t),r)}var e=b.behavior.drag();e.origin(function(){return d(this)}),e.on("drag",function(e,n){s();var r=t(b.event.x,e.p1,e.p2);k[E[e.p1]].endPos=r,k[E[e.p2]].startPos=r,k=p(k,A),b.select(this).attr("transform",function(t,e){return"translate("+r+",0)"}),b.select("#slider").call(v),m(),i()}),b.select("#slider").call(v);var n=b.select("#slider").selectAll(".slider-input__handle").data(g(_)).enter().append("g").attr({"class":"slider-input__handle","data-p1":function(t){return t.p1},"data-p2":function(t){return t.p2},transform:function(t){return"translate("+c(t.p1).endPos+",0)"}}).call(e);n.append("use").attr({"xlink:href":"#slider-handle-graphic","class":"interactive-input",transform:"translate(-"+L/2+","+T+")"}),n.append("rect").attr({x:0,y:0,width:L,height:2*T,"class":"interactive-input",fill:"#000","fill-opacity":0,transform:"translate(-"+L/2+","+T+")"}),b.select("#slider").selectAll(".slider-input__handle").attr("transform",function(t){return"translate("+c(t.p1).endPos+",0)"})}function v(t){var e=19,n=t.selectAll(".slider-input__bar").data(k).enter().append("g").attr({"class":function(t){return"slider-input__bar "+x.className(t.party)+"-area"},transform:function(t){return"translate("+t.startPos+",0)"}});n.append("rect").attr({width:function(t){return t.endPos-t.startPos},height:T});var r=n.append("text").attr({"class":function(t){return _.indexOf(t.party)<0?"slider-input__label hidden":"slider-input__label"},y:e-3});return r.append("tspan").attr({"class":"slider-input__label__party",x:4}).text(function(t){return x.shortName(t.party)}),r.append("tspan").attr({"class":"slider-input__label__seats",x:4,dy:e}).text(function(t){return t.seats}),t.selectAll(".slider-input__bar").attr({transform:function(t){return"translate("+t.startPos+",0)"}}),t.selectAll(".slider-input__bar rect").attr({width:function(t){return t.endPos-t.startPos}}),t.selectAll(".slider-input__label__party").text(function(t){return x.shortName(t.party)}),t.selectAll(".slider-input__label__seats").text(function(t){return t.seats}),t}function g(t){for(var e=[],n=0;n<t.length-1;n++)e.push({p1:t[n],p2:t[n+1]});return e}function h(t){var e=[],n=0;return t.forEach(function(t,r){var a={};a.party=t,a.startPos=n,n+=O(c(t).seats),a.endPos=n,e.push(a)}),e}function m(){function t(t){return O(t.value)+j.left}var e=325,n=o(),r=10,a=14,i=N.length*(a+r)+j.top+j.bottom,s=b.select(".coalition-display svg").attr({height:i}).selectAll(".coalition-display__majority-marker").data([{value:e,label:"Majority ("+e+")"}]).enter();s.append("line").attr({x1:t,y1:0,x2:t,y2:i,"shape-rendering":"crispEdges","class":"coalition-display__majority-marker"}),s.append("text").attr({x:function(e){return t(e)+4},y:i-j.bottom+13,"class":"axis-label"}).text(function(t){return t.label}),b.selectAll(".coalition-display__majority-marker").attr({x1:t,y1:0,x2:t,y2:i,"class":"coalition-display__majority-marker"}),b.selectAll(".axis-label").attr({x:function(e){return t(e)+4},y:i-j.bottom+13});var l=b.select(".coalitions-display").selectAll(".party-grouping").data(n,function(t){return t.parties.join(",")}).enter().append("g").attr({"class":function(t){var n="";return t.seats>e&&(n="viable"),"party-grouping "+n},transform:function(t,e){return"translate(0,"+(j.top+e*(a+r))+")"}});b.select(".coalitions-display").selectAll(".party-grouping").attr("class",function(t){var n="";return t.seats>e&&(n="viable"),"party-grouping "+n}),l.append("text").attr({transform:"translate("+(j.left-3)+","+a+")","text-anchor":"end"}).text(function(t){return t.parties.map(x.shortName).join(", ")}),l.append("g").attr({"class":"party-grouping__bar-stack",transform:"translate("+j.left+","+a+")"}),b.selectAll(".party-grouping__bar-stack").data(n).each(function(t){var e=b.select(this),n=e.selectAll("text").data([t]);n.enter().append("text"),e.selectAll("text").attr("transform",function(t){return"translate("+(O(t.seats)+3)+",0)"}).text(function(t){return t.seats});var r=h(t.parties);e.selectAll(".party-grouping__bar-stack__party").data(r,function(t){return t.party}).enter().append("rect").attr({"class":function(t){return"party-grouping__bar-stack__party "+x.className(t.party)+"-area borderless"}}),e.selectAll(".party-grouping__bar-stack__party").attr({x:function(t){return t.startPos},y:-a,width:function(t){return t.endPos-t.startPos},height:a})})}var _,b=t("d3"),x=t("uk-political-parties"),w=t("lodash/function/debounce"),P={top:5,left:0,bottom:0,right:0},j={top:1,left:160,bottom:20,right:50},k=[],A=b.scale.linear().clamp(!0),O=b.scale.linear(),E={},N=[["c"],["lab"],["ld","c"],["ld","lab"],["snp","lab"],["dup","c"],["ukip","c"],["ld","snp","lab"],["dup","ld","c"],["ukip","ld","c"],["ukip","dup","c"],["ukip","dup","ld","c"],["green","sdlp","snp","lab"],["green","pc","snp","lab"],["green","pc","ld","lab"],["green","sdlp","pc","snp","lab"],["c","lab"]],T=40,L=31,M=36,C=T+P.top+P.bottom+M;t("./ready.js").then(function(){k=l(forecast.data),f(),y(),m()});var D=w(function(t){f(),y(),m()},50);window.addEventListener("resize",D,!1)},{"./ready.js":2,d3:"d3","lodash/function/debounce":4,"uk-political-parties":"uk-political-parties"}],2:[function(t,e,n){"use strict";e.exports=new Promise(function(t){function e(){r.removeEventListener(n,e),r.dispatchEvent(new CustomEvent("o."+n)),t()}var n="DOMContentLoaded",r=document,a="interactive"===r.readyState||"complete"===r.readyState;a?e():r.addEventListener(n,e)})},{}],3:[function(t,e,n){var r=t("../internal/getNative"),a=r(Date,"now"),i=a||function(){return(new Date).getTime()};e.exports=i},{"../internal/getNative":5}],4:[function(t,e,n){function r(t,e,n){function r(){h&&clearTimeout(h),f&&clearTimeout(f),_=0,f=h=m=void 0}function l(e,n){n&&clearTimeout(n),f=h=m=void 0,e&&(_=i(),y=t.apply(g,d),h||f||(d=g=void 0))}function c(){var t=e-(i()-v);0>=t||t>e?l(m,f):h=setTimeout(c,t)}function u(){l(x,h)}function p(){if(d=arguments,v=i(),g=this,m=x&&(h||!w),b===!1)var n=w&&!h;else{f||w||(_=v);var r=b-(v-_),a=0>=r||r>b;a?(f&&(f=clearTimeout(f)),_=v,y=t.apply(g,d)):f||(f=setTimeout(u,r))}return a&&h?h=clearTimeout(h):h||e===b||(h=setTimeout(c,e)),n&&(a=!0,y=t.apply(g,d)),!a||h||f||(d=g=void 0),y}var d,f,y,v,g,h,m,_=0,b=!1,x=!0;if("function"!=typeof t)throw new TypeError(s);if(e=0>e?0:+e||0,n===!0){var w=!0;x=!1}else a(n)&&(w=!!n.leading,b="maxWait"in n&&o(+n.maxWait||0,e),x="trailing"in n?!!n.trailing:x);return p.cancel=r,p}var a=t("../lang/isObject"),i=t("../date/now"),s="Expected a function",o=Math.max;e.exports=r},{"../date/now":3,"../lang/isObject":9}],5:[function(t,e,n){function r(t,e){var n=null==t?void 0:t[e];return a(n)?n:void 0}var a=t("../lang/isNative");e.exports=r},{"../lang/isNative":8}],6:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}e.exports=r},{}],7:[function(t,e,n){function r(t){return a(t)&&o.call(t)==i}var a=t("./isObject"),i="[object Function]",s=Object.prototype,o=s.toString;e.exports=r},{"./isObject":9}],8:[function(t,e,n){function r(t){return null==t?!1:a(t)?u.test(l.call(t)):i(t)&&s.test(t)}var a=t("./isFunction"),i=t("../internal/isObjectLike"),s=/^\[object .+?Constructor\]$/,o=Object.prototype,l=Function.prototype.toString,c=o.hasOwnProperty,u=RegExp("^"+l.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},{"../internal/isObjectLike":6,"./isFunction":7}],9:[function(t,e,n){function r(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=r},{}]},{},[1]);
